ImagePost.styles = <%=
  ImagePost::Style.all.map do |style|
    json = style.as_json
    if style.background_image
      json["backgroundImageUrl"] = image_path(style.background_image)
    end
    next json
  end.to_json
%>;

$.each(ImagePost.styles, function(index, style){
  if (!style.backgroundImageUrl) return;
  var image = new Image
  image.src = style.backgroundImageUrl;
  style.backgroundImage = image;
});

ImagePost.randomStyleIndex = function(not) {
  var index = not;

  while (index == not) index = Math.floor(Math.random()*ImagePost.styles.length);
  return index
};
